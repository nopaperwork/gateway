spring.application.name=gateway
server.port=8080
spring.profiles.active=default
server.shutdown=graceful
# spring.config.import=optional:configserver:http://localhost:8888/configurations/

schema.sql=schema.sql

profile.msg = API Gateway Details for all MicroService
profile.build-version=v1

server.servlet.context-path=/gateway

spring.r2dbc.url=r2dbc:postgresql://ep-bold-bar-a1l33ibu-pooler.ap-southeast-1.aws.neon.tech/metis?sslmode=require
spring.r2dbc.properties.schema=way
spring.r2dbc.username=metis_owner
spring.r2dbc.password=npg_Jb1MVzHtu8Oj
spring.r2dbc.pool.enabled=true	
spring.r2dbc.pool.initial-size=10
spring.r2dbc.pool.max-size=30
spring.r2dbc.pool.max-idle-time=30m
spring.r2dbc.pool.max-acquire-time=3s
spring.r2dbc.pool.validation-query=SELECT 1

spring.flyway.enabled=false

# Redis Configuration

## TOGGLE FOR ENABLING REDIS - (When set to false, Spring Boot will not automatically scan for and create 
## implementations for interfaces extending RedisRepository or other Spring Data Redis repository marker interfaces.)
spring.data.redis.repositories.enabled=true

# Redis Configuration for Rate Limiter and Cache)
spring.data.redis.host=redis-10858.c246.us-east-1-4.ec2.redns.redis-cloud.com
spring.data.redis.port=10858

spring.data.redis.timeout=2000ms
spring.data.redis.jedis.pool.max-active=8
spring.data.redis.jedis.pool.max-idle=8
spring.data.redis.jedis.pool.min-idle=2

## --- Caching Configuration ---
gateway.cache.routes-ttl-minutes=10
gateway.cache.ip-blacklist-ttl-minutes=30

## Set the cache type to redis to enable distributed caching.
spring.cache.type=redis

# Optional: Set a password if your Redis server requires authentication
spring.data.redis.username=default
spring.data.redis.password=h2I0lXCqBMgQkYxwOJLx2ckYoI35yEWO

# Optional: Configure Redis database index (default is 0)
spring.data.redis.database=0

# Optional: Configure cache-specific properties for Redis
spring.cache.redis.time-to-live=60000
# CUSTOM TTL
gateway.routes.cache-ttl=60000
# Cache entries expire after 60 seconds (in milliseconds)

# spring.cache.redis.cache-null-values=true # Allow caching of null values
spring.cache.redis.key-prefix=gateway: 
# Prefix for cache keys

spring.cloud.gateway.server.webflux.metrics.enabled=true
spring.cloud.gateway.server.webflux.httpclient.pool.type=elastic
spring.cloud.gateway.server.webflux.httpclient.pool.max-idle-time=15s
spring.cloud.gateway.server.webflux.httpclient.pool.max-life-time=60s
spring.cloud.gateway.server.webflux.httpclient.response-timeout=30s
spring.cloud.gateway.server.webflux.httpclient.wiretap=false

spring.cloud.gateway.server.webflux.discovery.locator.enabled=false

spring.task.execution.pool.core-size=10
spring.task.execution.pool.max-size=20
spring.task.execution.pool.queue-capacity=100

spring.cloud.gateway.filter.request-rate-limiter.redis-rate-limiter.replenish-rate=10
spring.cloud.gateway.filter.request-rate-limiter.redis-rate-limiter.burst-capacity=20
spring.cloud.gateway.filter.request-rate-limiter.redis-rate-limiter.requested-tokens=1

logging.level.root=INFO
logging.level.com.nopaper.work.gateway=DEBUG
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.io.r2dbc.postgresql=DEBUG
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

management.endpoints.web.exposure.include=health,info,metrics,prometheus,gateway
management.endpoint.health.show-details=always
# management.endpoint.gateway.enabled=true
# management.endpoint.gateway.access=true

management.prometheus.metrics.export.enabled=true

gateway.audit.enabled=true
gateway.audit.log-request-body=false
gateway.audit.log-response-body=false